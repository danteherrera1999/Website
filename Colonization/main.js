const colony_data = {
	"Orbital": {
		"Starport": {
			"Coriolis": {
				"data": {
					"T2": -3,
					"T3": 1,
					"Security": -2,
					"Tech Level": 1,
					"Wealth": 2,
					"Standard of Living": 3,
					"Development Level": 2,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 1,
					"Max Population Increase": 0
				}
			},
			"Asteroid Base": {
				"data": {
					"T2": -3,
					"T3": 1,
					"Security": -1,
					"Tech Level": 3,
					"Wealth": 5,
					"Standard of Living": -4,
					"Development Level": 7,
					"Facility Economy": "Extraction",
					"Economy Influence": "",
					"Initial Population Increase": 1,
					"Max Population Increase": 0
				}
			},
			"Ocellus": {
				"data": {
					"T2": 0,
					"T3": -6,
					"Security": -3,
					"Tech Level": 6,
					"Wealth": 7,
					"Standard of Living": 5,
					"Development Level": 8,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 5,
					"Max Population Increase": 1
				}
			},
			"Orbis": {
				"data": {
					"T2": 0,
					"T3": -6,
					"Security": -3,
					"Tech Level": 6,
					"Wealth": 7,
					"Standard of Living": 5,
					"Development Level": 8,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 5,
					"Max Population Increase": 1
				}
			}
		},
		"Outpost": {
			"Commercial": {
				"alias": "Commercial Outpost",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -1,
					"Tech Level": 0,
					"Wealth": 2,
					"Standard of Living": 5,
					"Development Level": 0,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Industrial": {
				"alias": "Industrial Outpost",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 0,
					"Tech Level": 3,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 2,
					"Facility Economy": "Industrial",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Criminal": {
				"alias": "Criminal Outpost",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -2,
					"Tech Level": 0,
					"Wealth": 2,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "Colony",
					"Economy Influence": "Contraband",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Civilian": {
				"alias": "Civilian Outpost",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -1,
					"Tech Level": 0,
					"Wealth": 1,
					"Standard of Living": 1,
					"Development Level": 1,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Scientific": {
				"alias": "Scientific Outpost",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 0,
					"Tech Level": 3,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "Hightech",
					"Economy Influence": "",
					"Initial Population Increase": 1,
					"Max Population Increase": 0
				}
			},
			"Military": {
				"alias": "Military Outpost",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 2,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "Military",
					"Economy Influence": "",
					"Initial Population Increase": 1,
					"Max Population Increase": 0
				}
			}
		},
		"Installation": {
			"Satellite": {
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 0,
					"Tech Level": 0,
					"Wealth": 1,
					"Standard of Living": 1,
					"Development Level": 1,
					"Facility Economy": "",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Comm Station": {
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 1,
					"Tech Level": 3,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Space Farm": {
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 0,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 5,
					"Development Level": 1,
					"Facility Economy": "",
					"Economy Influence": "Agricultural",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Pirate Base": {
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -4,
					"Tech Level": 0,
					"Wealth": 3,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Contraband",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Mining Outpost": {
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 0,
					"Tech Level": 0,
					"Wealth": 3,
					"Standard of Living": -2,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Extraction",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Relay Station": {
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": 1,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 1,
					"Facility Economy": "",
					"Economy Influence": "Hightech",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Military": {
				"alias": "Military Installation",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 6,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Military",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Security Station": {
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 8,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 3,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "Military",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Government": {
				"alias": "Government Installation",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 2,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 6,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Medical": {
				"alias": "Medical Installation",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 0,
					"Tech Level": 3,
					"Wealth": 0,
					"Standard of Living": 5,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Hightech",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Research Station": {
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 0,
					"Tech Level": 8,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "Hightech",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Tourist": {
				"alias": "Tourist Installation",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -3,
					"Tech Level": 0,
					"Wealth": 6,
					"Standard of Living": 0,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "Tourism",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Space Bar": {
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -2,
					"Tech Level": 0,
					"Wealth": 2,
					"Standard of Living": 3,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Tourism",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			}
		}
	},
	"Surface": {
		"Planetary Port": {
			"Outpost Civilian": {
				"alias": "Civilian Port",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -2,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 3,
					"Development Level": 0,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 2,
					"Max Population Increase": 0
				}
			},
			"Outpost Industrial": {
				"alias": "Industrial Port",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -1,
					"Tech Level": 0,
					"Wealth": 2,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "Industrial",
					"Economy Influence": "",
					"Initial Population Increase": 1,
					"Max Population Increase": 0
				}
			},
			"Outpost Scientific": {
				"alias": "Scientific Port",
				"data": {
					"T2": 1,
					"T3": 0,
					"Security": -1,
					"Tech Level": 5,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 1,
					"Facility Economy": "Hightech",
					"Economy Influence": "",
					"Initial Population Increase": 1,
					"Max Population Increase": 0
				}
			},
			"Port": {
				"alias": "Planetary Port",
				"data": {
					"T2": 0,
					"T3": -6,
					"Security": -3,
					"Tech Level": 5,
					"Wealth": 5,
					"Standard of Living": 6,
					"Development Level": 10,
					"Facility Economy": "Colony",
					"Economy Influence": "",
					"Initial Population Increase": 10,
					"Max Population Increase": 10
				}
			}
		},
		"Settlement": {
			"Agriculture": {
				"Small": {
					"alias": "Agriculture Settlement (S)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 3,
						"Development Level": 0,
						"Facility Economy": "Agricultural",
						"Economy Influence": "Agricultural",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Medium": {
					"alias": "Agriculture Settlement (M)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 6,
						"Development Level": 0,
						"Facility Economy": "Agricultural",
						"Economy Influence": "Agricultural",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Large": {
					"alias": "Agriculture Settlement (L)",
					"data": {
						"T2": -1,
						"T3": 2,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 10,
						"Development Level": 0,
						"Facility Economy": "Agricultural",
						"Economy Influence": "Agricultural",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				}
			},
			"Extraction": {
				"Small": {
					"alias": "Extraction Settlement (S)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 2,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Extraction",
						"Economy Influence": "Extraction",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Medium": {
					"alias": "Extraction Settlement (M)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 5,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Extraction",
						"Economy Influence": "Extraction",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Large": {
					"alias": "Extraction Settlement (L)",
					"data": {
						"T2": -1,
						"T3": 2,
						"Security": 0,
						"Tech Level": 1,
						"Wealth": 7,
						"Standard of Living": -2,
						"Development Level": 0,
						"Facility Economy": "Extraction",
						"Economy Influence": "Extraction",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				}
			},
			"Industrial": {
				"Small": {
					"alias": "Industrial Settlement (S)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 2,
						"Facility Economy": "Industrial",
						"Economy Influence": "Industrial",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Medium": {
					"alias": "Industrial Settlement (M)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 5,
						"Facility Economy": "Industrial",
						"Economy Influence": "Industrial",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Large": {
					"alias": "Industrial Settlement (L)",
					"data": {
						"T2": -1,
						"T3": 2,
						"Security": 0,
						"Tech Level": 0,
						"Wealth": 2,
						"Standard of Living": 0,
						"Development Level": 8,
						"Facility Economy": "Industrial",
						"Economy Influence": "Industrial",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				}
			},
			"Military": {
				"Small": {
					"alias": "Military Settlement (S)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 2,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Military",
						"Economy Influence": "Military",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Medium": {
					"alias": "Military Settlement (M)",
					"data": {
						"T2": 1,
						"T3": 0,
						"Security": 4,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Military",
						"Economy Influence": "Military",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Large": {
					"alias": "Military Settlement (L)",
					"data": {
						"T2": -1,
						"T3": 2,
						"Security": 6,
						"Tech Level": 0,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 2,
						"Facility Economy": "Military",
						"Economy Influence": "Military",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				}
			},
			"Research": {
				"Small": {
					"alias": "Research Settlement (S)",
					"data": {
						"T2": -1,
						"T3": 1,
						"Security": 0,
						"Tech Level": 3,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 1,
						"Facility Economy": "Hightech",
						"Economy Influence": "Hightech",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Medium": {
					"alias": "Research Settlement (M)",
					"data": {
						"T2": -1,
						"T3": 1,
						"Security": 0,
						"Tech Level": 6,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 1,
						"Facility Economy": "Hightech",
						"Economy Influence": "Hightech",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Large": {
					"alias": "Research Settlement (L)",
					"data": {
						"T2": -1,
						"T3": 2,
						"Security": 0,
						"Tech Level": 10,
						"Wealth": 0,
						"Standard of Living": 0,
						"Development Level": 2,
						"Facility Economy": "Hightech",
						"Economy Influence": "Hightech",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				}
			},
			"Tourism": {
				"Small": {
					"alias": "Tourism Settlement (S)",
					"data": {
						"T2": -1,
						"T3": 1,
						"Security": -1,
						"Tech Level": 0,
						"Wealth": 1,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Tourism",
						"Economy Influence": "Tourism",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Medium": {
					"alias": "Tourism Settlement (M)",
					"data": {
						"T2": -1,
						"T3": 1,
						"Security": -1,
						"Tech Level": 0,
						"Wealth": 2,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Tourism",
						"Economy Influence": "Tourism",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				},
				"Large": {
					"alias": "Tourism Settlement (L)",
					"data": {
						"T2": -1,
						"T3": 2,
						"Security": -1,
						"Tech Level": 0,
						"Wealth": 5,
						"Standard of Living": 0,
						"Development Level": 0,
						"Facility Economy": "Tourism",
						"Economy Influence": "Tourism",
						"Initial Population Increase": 0,
						"Max Population Increase": 0
					}
				}
			}
		},
		"Hub": {
			"Extraction": {
				"alias": "Extraction Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 0,
					"Tech Level": 0,
					"Wealth": 10,
					"Standard of Living": -4,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "Extraction",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Civilian": {
				"alias": "Civilian Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -3,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 3,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Exploration": {
				"alias": "Exploration Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -1,
					"Tech Level": 6,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "Tourism",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Outpost": {
				"alias": "Outpost Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -2,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 3,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Scientific": {
				"alias": "Scientific Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 0,
					"Tech Level": 10,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Hightech",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Military": {
				"alias": "Military Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 10,
					"Tech Level": 0,
					"Wealth": 0,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Military",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Refinery": {
				"alias": "Refinery Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -1,
					"Tech Level": 3,
					"Wealth": 5,
					"Standard of Living": -2,
					"Development Level": 7,
					"Facility Economy": "",
					"Economy Influence": "Refinery",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"High Tech": {
				"alias": "High Tech Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": -2,
					"Tech Level": 10,
					"Wealth": -2,
					"Standard of Living": 0,
					"Development Level": 0,
					"Facility Economy": "",
					"Economy Influence": "Hightech",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			},
			"Industrial": {
				"alias": "Industrial Hub",
				"data": {
					"T2": -1,
					"T3": 1,
					"Security": 0,
					"Tech Level": 3,
					"Wealth": 5,
					"Standard of Living": -4,
					"Development Level": 2,
					"Facility Economy": "",
					"Economy Influence": "Industrial",
					"Initial Population Increase": 0,
					"Max Population Increase": 0
				}
			}
		}
	}
}
const symbol_map = {
	"Coriolis": { "symbol": "A", "data": colony_data["Orbital"]["Starport"]["Coriolis"] },
	"Asteroid Base": { "symbol": "B", "data": colony_data["Orbital"]["Starport"]["Asteroid Base"] },
	"Ocellus": { "symbol": "C", "data": colony_data["Orbital"]["Starport"]["Ocellus"] },
	"Orbis": { "symbol": "D", "data": colony_data["Orbital"]["Starport"]["Orbis"] },
	"Commercial Outpost": { "symbol": "E", "data": colony_data["Orbital"]["Outpost"]["Commercial"] },
	"Industrial Outpost": { "symbol": "F", "data": colony_data["Orbital"]["Outpost"]["Industrial"] },
	"Criminal Outpost": { "symbol": "G", "data": colony_data["Orbital"]["Outpost"]["Criminal"] },
	"Civilian Outpost": { "symbol": "H", "data": colony_data["Orbital"]["Outpost"]["Civilian"] },
	"Scientific Outpost": { "symbol": "I", "data": colony_data["Orbital"]["Outpost"]["Scientific"] },
	"Military Outpost": { "symbol": "J", "data": colony_data["Orbital"]["Outpost"]["Military"] },
	"Satellite": { "symbol": "K", "data": colony_data["Orbital"]["Installation"]["Satellite"] },
	"Comm Station": { "symbol": "L", "data": colony_data["Orbital"]["Installation"]["Comm Station"] },
	"Space Farm": { "symbol": "M", "data": colony_data["Orbital"]["Installation"]["Space Farm"] },
	"Pirate Base": { "symbol": "N", "data": colony_data["Orbital"]["Installation"]["Pirate Base"] },
	"Mining Outpost": { "symbol": "O", "data": colony_data["Orbital"]["Installation"]["Mining Outpost"] },
	"Relay Station": { "symbol": "P", "data": colony_data["Orbital"]["Installation"]["Relay Station"] },
	"Military Installation": { "symbol": "Q", "data": colony_data["Orbital"]["Installation"]["Military"] },
	"Security Station": { "symbol": "R", "data": colony_data["Orbital"]["Installation"]["Security Station"] },
	"Government Installation": { "symbol": "S", "data": colony_data["Orbital"]["Installation"]["Government"] },
	"Medical Installation": { "symbol": "T", "data": colony_data["Orbital"]["Installation"]["Medical"] },
	"Research Station": { "symbol": "U", "data": colony_data["Orbital"]["Installation"]["Research Station"] },
	"Tourist Installation": { "symbol": "V", "data": colony_data["Orbital"]["Installation"]["Tourist"] },
	"Space Bar": { "symbol": "W", "data": colony_data["Orbital"]["Installation"]["Space Bar"] },
	"Civilian Port": { "symbol": "X", "data": colony_data["Surface"]["Planetary Port"]["Outpost Civilian"] },
	"Industrial Port": { "symbol": "Y", "data": colony_data["Surface"]["Planetary Port"]["Outpost Industrial"] },
	"Scientific Port": { "symbol": "Z", "data": colony_data["Surface"]["Planetary Port"]["Outpost Scientific"] },
	"Planetary Port": { "symbol": "a", "data": colony_data["Surface"]["Planetary Port"]["Port"] },
	"Agriculture Settlement (S)": { "symbol": "b", "data": colony_data["Surface"]["Settlement"]["Agriculture"]["Small"] },
	"Agriculture Settlement (M)": { "symbol": "c", "data": colony_data["Surface"]["Settlement"]["Agriculture"]["Medium"] },
	"Agriculture Settlement (L)": { "symbol": "d", "data": colony_data["Surface"]["Settlement"]["Agriculture"]["Large"] },
	"Extraction Settlement (S)": { "symbol": "e", "data": colony_data["Surface"]["Settlement"]["Extraction"]["Small"] },
	"Extraction Settlement (M)": { "symbol": "f", "data": colony_data["Surface"]["Settlement"]["Extraction"]["Medium"] },
	"Extraction Settlement (L)": { "symbol": "g", "data": colony_data["Surface"]["Settlement"]["Extraction"]["Large"] },
	"Industrial Settlement (S)": { "symbol": "h", "data": colony_data["Surface"]["Settlement"]["Industrial"]["Small"] },
	"Industrial Settlement (M)": { "symbol": "i", "data": colony_data["Surface"]["Settlement"]["Industrial"]["Medium"] },
	"Industrial Settlement (L)": { "symbol": "j", "data": colony_data["Surface"]["Settlement"]["Industrial"]["Large"] },
	"Military Settlement (S)": { "symbol": "k", "data": colony_data["Surface"]["Settlement"]["Military"]["Small"] },
	"Military Settlement (M)": { "symbol": "l", "data": colony_data["Surface"]["Settlement"]["Military"]["Medium"] },
	"Military Settlement (L)": { "symbol": "m", "data": colony_data["Surface"]["Settlement"]["Military"]["Large"] },
	"Research Settlement (S)": { "symbol": "n", "data": colony_data["Surface"]["Settlement"]["Research"]["Small"] },
	"Research Settlement (M)": { "symbol": "o", "data": colony_data["Surface"]["Settlement"]["Research"]["Medium"] },
	"Research Settlement (L)": { "symbol": "p", "data": colony_data["Surface"]["Settlement"]["Research"]["Large"] },
	"Tourism Settlement (S)": { "symbol": "q", "data": colony_data["Surface"]["Settlement"]["Tourism"]["Small"] },
	"Tourism Settlement (M)": { "symbol": "r", "data": colony_data["Surface"]["Settlement"]["Tourism"]["Medium"] },
	"Tourism Settlement (L)": { "symbol": "s", "data": colony_data["Surface"]["Settlement"]["Tourism"]["Large"] },
	"Extraction Hub": { "symbol": "t", "data": colony_data["Surface"]["Hub"]["Extraction"] },
	"Civilian Hub": { "symbol": "u", "data": colony_data["Surface"]["Hub"]["Civilian"] },
	"Exploration Hub": { "symbol": "v", "data": colony_data["Surface"]["Hub"]["Exploration"] },
	"Outpost Hub": { "symbol": "w", "data": colony_data["Surface"]["Hub"]["Outpost"] },
	"Scientific Hub": { "symbol": "x", "data": colony_data["Surface"]["Hub"]["Scientific"] },
	"Military Hub": { "symbol": "y", "data": colony_data["Surface"]["Hub"]["Military"] },
	"Refinery Hub": { "symbol": "z", "data": colony_data["Surface"]["Hub"]["Refinery"] },
	"High Tech Hub": { "symbol": "0", "data": colony_data["Surface"]["Hub"]["High Tech"] },
	"Industrial Hub": { "symbol": "1", "data": colony_data["Surface"]["Hub"]["Industrial"] }
}
const trackedData = ['T2', 'T3', 'Security', 'Tech Level', 'Wealth', 'Standard of Living', 'Development Level', 'Facility Economy', 'Economy Influence', 'Initial Population Increase', 'Max Population Increase'];
const trackedDataAlias = ['Tier 2', 'Tier 3', 'Security', 'Tech Level', 'Wealth', 'Standard of Living', 'Development Level', 'Facility Economy', 'Economy Influence', 'Initial Pop', 'Max Pop'];
trackedDataSumType = ['sum', 'sum', 'sum', 'sum', 'sum', 'sum', 'sum', 'none', 'mode', 'sum', 'sum']
const starports = ['Coriolis', 'Asteroid Base', 'Ocellus', 'Orbis', 'Planetary Port'];
const params = new URLSearchParams(document.location.search);
class layeredDropdown {
	constructor(dropdown_dict, parent = null, element = null) {
		this.parent = parent;
		this.data = null;
		this.name = null;
		this.element = element;
		this.children = this.generateChildren(dropdown_dict);
		this.menu = this.generateMenu();
	}
	propogateData(data) {
		if (this.parent != null) {
			this.parent.propogateData(data);
		}
	}
	handleEnter() {
		if (this.parent != null) {
			this.parent.children.map((child) => { if (child.menu != null) { child.menu.style.display = 'none' }; child.element.classList.remove('active') });
			this.propgateActive();
		}
		if (this.children != null) {
			this.menu.style.display = "block";
		}
	}
	propgateHide() {
		if (this.menu != null) {
			this.menu.style.display = 'none';
		}
		if (this.parent != null) {
			this.parent.propgateHide();
		}
	}
	propgateActive() {
		this.element.classList.add('active');
		if (this.parent != null) {
			this.parent.propgateActive();
		}
	}
	generateChild(dropdown_dict, key) {
		const newElement = document.createElement("li");
		newElement.classList.add("dropdown-submenu");
		const newA = document.createElement("a");
		newA.innerHTML = key;
		newA.href = "#";
		newA.tabIndex = "-1";
		newElement.appendChild(newA);
		const newLayeredDropdown = new layeredDropdown(dropdown_dict[key], this, newElement);
		newLayeredDropdown.name = Object.keys(dropdown_dict[key]).includes("alias") ? dropdown_dict[key]["alias"] : key;
		newA.addEventListener("click", (e) => newLayeredDropdown.handleClick(e));
		newA.addEventListener("mouseenter", () => newLayeredDropdown.handleEnter());
		newA.addEventListener("mouseleave", () => newElement.classList.remove('active'));
		return newLayeredDropdown
	}
	generateChildren(dropdown_dict) {
		if (Object.keys(dropdown_dict).includes("data")) {
			this.data = dropdown_dict["data"];
			return null
		}
		else {
			return Object.keys(dropdown_dict).map((key) => this.generateChild(dropdown_dict, key))
		}
	}
	generateMenu() {
		if (this.children != null) {
			const newElement = document.createElement("ul");
			newElement.classList.add("dropdown-menu");
			newElement.setAttribute("style", "top: 0 !important; left:100% !important")
			this.children.map((child) => newElement.appendChild(child.element))
			this.element.appendChild(newElement)
			return newElement
		}
		else {
			return null
		}
	}
	handleClick(e) {
		if (this.menu == null) {
			this.propogateData({ "name": this.name, "data": this.data });
			this.propgateHide();
		}
		e.stopPropagation();
		e.preventDefault();
	}
	handleConfigure(e) {
		if (this.data != null) {
			document.addEventListener("mouseup", (event) => { this.structureBox.handleMove(this, event.target) }, { once: true });
		}
	}
}
class structureElement extends layeredDropdown {
	constructor(dropdown_dict, container = null, element = null, structureBox) {
		super(dropdown_dict, null, element);
		this.structureBox = structureBox;
		this.container = container;
		this.generateRootElement();
		this.dField = this.generateDataField();
	}
	generateRootElement() {
		const newP = document.createElement("p");
		newP.innerHTML = "Select";
		const newBtn = document.createElement("button");
		const newSpan = document.createElement('span');
		const confBtn = document.createElement("button");
		confBtn.setAttribute('style', 'padding:0;height:100%;width:10%;top:0;margin:0;border:none;background:rgba(0,0,0,0);');
		confBtn.innerHTML = `${this.structureBox.totalStructures}.`;
		confBtn.classList.add("menu-icon");
		confBtn.addEventListener("mousedown", (e) => this.handleConfigure(e))
		this.element.setAttribute("style", "display:flex;flex-direction:row;align-items:center")
		newP.setAttribute('style', 'padding:0;width:80%;border:none;text-align:center;margin:0;');
		newBtn.setAttribute('style', 'padding:0;height:100%;width:10%;top:0;margin:0;border:none;background:rgba(0,0,0,0);');
		newBtn.setAttribute('data-toggle', "dropdown")
		newSpan.classList.add('caret');
		newBtn.appendChild(newSpan);
		newBtn.addEventListener("click", () => { this.menu.style.display = "block"; newBtn.setAttribute("aria-expanded", "true"); this.element.classList.add("open", "active") });
		this.element.appendChild(confBtn);
		this.element.appendChild(newP);
		this.element.appendChild(newBtn);
		document.addEventListener("click", (e) => { if (!(this.element.contains(e.target))) { this.menu.style.display = "none" } });
	}
	populateDataField() {
		const cells = this.dField.children;
		for (let i = 0; i < trackedData.length; i++) {
			const newData = this.data[trackedData[i]];
			cells[i].querySelector("p").innerHTML = newData != "" ? newData : "-";
			if (Number.isInteger(newData)) {
				if (newData == 0) {
					cells[i].style.backgroundColor = 'lightgrey';
					//cells[i].style.backgroundColor = 'black';
				}
				else {
					cells[i].style.backgroundColor = (newData>0)? "rgba(51, 255, 75, 1)":"rgba(255, 51, 51, 1)";
					//cells[i].style.backgroundColor = 'black';
				}
			}
			else {
				cells[i].style.backgroundColor = 'lightgrey'
			};
		}
	}
	generateDataField() {
		const newDField = document.createElement('div');
		newDField.setAttribute('style', "display:flex;flex-direction:row;")
		newDField.classList.add("structure-dfield");
		this.container.appendChild(newDField);
		const cellWidth = Math.round(100 / trackedData.length);
		for (let i = 0; i < trackedData.length; i++) {
			const newContainer = document.createElement('div');
			newContainer.setAttribute("style", `width: ${cellWidth}%;margin:0;height:100%;display:flex;align-items:center;`);
			const newCell = document.createElement('p');
			newCell.setAttribute("style", `margin:0; width:100%;text-align:center;height:fit-content;`);
			newContainer.appendChild(newCell);
			newDField.appendChild(newContainer);
		}
		return newDField;
	}
	propogateData(data) {
		this.update(data, true);
	}
	update(newData, updateHeader = false,noUpdate=false) {
		if (this.data == null & noUpdate==false) { this.structureBox.addStructure() };
		this.name = newData["name"];
		this.data = newData["data"];
		this.element.querySelector("p").innerHTML = this.name;
		this.populateDataField();
		if (updateHeader) { this.structureBox.updateHeaderData(); }
	}
}


class structureBox {
	constructor(element) {
		this.element = element;
		this.structures = [];
		this.totalStructures = 0;
		this.headerData = this.generateHeader();
	}
	addStructure() {
		const container = document.createElement("div");
		container.classList.add("structure-container");
		container.id = `structureContainer-${this.totalStructures}`;
		const structure = document.createElement("div");
		structure.classList.add("structure-element", "dropdown");
		structure.id = `structure-${this.totalStructures}`;
		this.totalStructures += 1;
		container.appendChild(structure);
		this.element.appendChild(container);
		const newStruct = new structureElement(colony_data, container, structure, this)
		this.structures.push(newStruct);
		return newStruct;
	}
	handleMove(origin, target) {
		this.structures.forEach((structure) => {
			if (structure != origin & target.nodeType === Node.ELEMENT_NODE) {
				if (structure.element.contains(target)) { target = structure };
			}
		});
		if (target instanceof structureElement) {
			var structure_data = this.structures.map((structure) => { return { 'name': structure.name, 'data': structure.data } });
			const i_origin = this.structures.indexOf(origin);
			const i_target = this.structures.indexOf(target);
			structure_data = this.moveElement(structure_data, i_origin, i_target);
			this.writeAllStructures(structure_data);
		}
	}
	writeAllStructures(structure_data) {
		for (let i = 0; i < this.structures.length - 1; i++) {
			this.structures[i].update(structure_data[i])
		}
		this.updateHeaderData();
	}
	moveElement(array, originIndex, targetIndex) {
		var newArray = [...array];
		newArray.splice(targetIndex, 0, array[originIndex]);
		newArray.splice((targetIndex > originIndex) ? originIndex : originIndex + 1, 1);
		return newArray;
	}
	generateHeader() {
		const cellWidth = Math.round(100 / trackedData.length);
		const headerLabels = document.getElementById("header-labels");
		headerLabels.setAttribute('style', "display:flex;flex-direction:row;width:80%;height:75%;float:right;align-items:end;");
		const headerData = document.getElementById("header-totals");
		headerData.setAttribute('style', "display:flex;flex-direction:row;right:0;width:80%;height:25%;float:right;align-items:center;");
		for (let i = 0; i < trackedData.length; i++) {
			const newHeader = document.createElement("p");
			const newData = document.createElement("p");
			newHeader.setAttribute("style", `width: ${cellWidth}%;margin:0;height:fit-content;text-align:center;`)
			newData.setAttribute("style", `width: ${cellWidth}%;margin:0;height:fit-content;text-align:center;`)
			newHeader.innerHTML = trackedDataAlias[i];
			newData.innerHTML = "-";
			headerLabels.appendChild(newHeader);
			headerData.appendChild(newData);
		}
		return headerData;
	}
	updateHeaderData() {
		this.updateStarportCosts();
		const cells = this.headerData.children;
		for (let i = 0; i < cells.length; i++) {
			let newData = i == 8 ? {} : 0;
			for (let j = 0; j < this.structures.length - 1; j++) {
				if (trackedDataSumType[i] == 'mode') {
					const newKey = this.structures[j].data[trackedData[i]];
					if (Object.keys(newData).includes(newKey)) {
						newData[newKey] += 1;
					}
					else if (newKey != '') {
						newData[newKey] = 1;
					}
				}
				else if (trackedDataSumType[i] == 'sum') {
					newData += this.structures[j].data[trackedData[i]];
				}
				else if (trackedDataSumType[i] == 'none') {
					newData = '-';
				}
			}
			if (trackedDataSumType[i] == 'mode') {
				var max = 0;
				Object.entries(newData).forEach(([key, value]) => { if (value > max) { max = value; newData = key } })
				newData = typeof newData === 'object' ? '-' : newData;
			}
			cells[i].innerHTML = newData;
		}
		this.updateURL();
	}
	updateStarportCosts() {
		for (let i = 1; i < this.structures.length - 1; i++) {
			if (starports.includes(this.structures[i].name)) {
				let N = 0;
				for (let j = 1; j < i; j++) {
					if (starports.includes(this.structures[j].name)) {
						N += 1;
					}
				}
				N = Math.floor(N / 2);
				var newData = { ...this.structures[i].data };
				if (newData['T3'] > 0) { newData['T2'] = -3 * (N+1) }
				else { newData['T3'] = -6 * (N+1) }
				this.structures[i].update({ 'name': this.structures[i].name, "data": newData });
			}
		}
		if (starports.includes(this.structures[0].name)) {
			var newData = { ...this.structures[0].data };
			if (newData['T3'] > 0) { newData['T2'] = 0 }
			else { newData['T3'] = 0 }
			this.structures[0].update({ 'name': this.structures[0].name, "data": newData });
		}
	}
	updateURL(){
		var structure_string = this.structures.slice(0,-1).map((structure)=>symbol_map[structure.name]["symbol"]).join('');
		params.set("s",structure_string);
		console.log(params)
		const newUrl = `${window.location.pathname}?${params.toString()}`;
		window.history.pushState({ path: newUrl }, '', newUrl);
	}
}

function InitializePage(AllStructures){
	const initString = params.get('s');
	console.log(initString);
	if (initString!=null){
		for (let i=0;i<initString.length;i++){
			Object.entries(symbol_map).forEach(([key,value])=>{if(initString[i]==value['symbol']){
				const newStuct = AllStructures.addStructure();
				newStuct.update({"name":key,"data":symbol_map[key]["data"]["data"]},false,true)
			}})
		}
	};
	AllStructures.addStructure()
	AllStructures.updateHeaderData();
}

var AllStructures = new structureBox(document.getElementById("structure-box"))
InitializePage(AllStructures);
